# 全域黑名單功能使用指南

## 功能概述

新增了完整的全域黑名單系統，包含黑名單管理、申訴機制和自動通知。

## 開發者指令

### 黑名單管理指令

```
/黑名單 新增 <用戶> [原因]
- 將用戶添加到黑名單
- 用戶被添加時會收到私訊通知和申訴按鈕
- 範例: /黑名單 新增 @使用者 原因是擾亂秩序

/黑名單 移除 <用戶>
- 從黑名單中移除用戶
- 用戶會收到移除通知
- 範例: /黑名單 移除 @使用者

/黑名單 列表
- 查看所有被黑名單的用戶
- 顯示用戶 ID 列表

/黑名單 待審申訴
- 查看所有待審核的申訴
- 顯示申訴用戶、原因和提交時間
```

## 使用者指令

### 申訴指令

```
/申訴
- 提交黑名單申訴
- 打開申訴表單，用戶填寫申訴原因
- 申訴內容會傳送給開發者審核

/申訴狀態
- 查看自己的申訴狀態
- 顯示申訴是否待處理、已接受或已拒絕
```

### 申訴流程

1. **黑名單用戶收到通知**
   - 被添加到黑名單時收到私訊
   - 包含一個紅色 Embed 和申訴按鈕

2. **提交申訴**
   - 點擊私訊中的申訴按鈕或使用 `/申訴` 指令
   - 填寫申訴表單（最多 1000 字）
   - 申訴自動發送給開發者

3. **開發者審核**
   - 開發者在私訊中看到待審申訴
   - 可點擊「接受申訴」或「拒絕申訴」按鈕
   - 申訴結果自動通知申訴用戶

4. **申訴結果**
   - 接受：用戶從黑名單移除，可重新使用命令
   - 拒絕：用戶仍在黑名單中

## 黑名單用戶限制

被黑名單的用戶：
- ✗ 無法使用任何命令（除申訴外）
- ✗ 無法使用混合命令的前綴版本
- ✓ 可以使用 `/申訴` 提交申訴
- ✓ 可以使用 `/申訴狀態` 查看申訴狀態
- ✓ 可以點擊私訊中的申訴按鈕

## 數據存儲

- **黑名單**: `data/storage/blacklist.json`
  ```json
  {
    "blacklisted_users": [用戶ID列表]
  }
  ```

- **申訴記錄**: `data/storage/appeals.json`
  ```json
  {
    "用戶ID": {
      "user_id": 用戶ID,
      "reason": "申訴原因",
      "status": "待處理|接受|拒絕",
      "created_at": "ISO時間戳",
      "reviewed_at": "ISO時間戳或null",
      "reviewed_by": "審核開發者ID或null"
    }
  }
  ```

## 特點

- **自動通知**: 黑名單和申訴結果自動通知相關用戶
- **表單驗證**: 申訴表單限制 1000 字，防止濫用
- **防重複申訴**: 同一用戶只能有一份待處理申訴
- **時區配置**: 所有時間戳使用 UTC+8 台灣時區
- **用戶友好**: 使用繁體中文，語言自然易懂
- **開發者友好**: 完整的審核界面和狀態管理

## 注意事項

1. 開發者 ID 設定為 `241619561760292866`，修改請編輯 `blacklist.py` 中的 `DEVELOPER_ID`
2. 申訴記錄不會自動刪除，開發者可在 `data/storage/appeals.json` 手動管理
3. 黑名單用戶被移除後，如有待處理申訴會自動標記為已接受
