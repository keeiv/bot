# 訊息編輯/刪除監聽功能

## 功能概述

這個 Cog 提供了完整的訊息編輯和刪除監聽功能，會自動記錄所有成員的訊息變更並發送到指定的日誌頻道。

## 主要功能

### 編輯監聽
- 監聽所有非 bot 成員的訊息編輯
- 顯示編輯前和編輯後的內容
- 記錄編輯次數
- 自動更新 JSON 記錄

### 刪除監聽
- 監聽所有非 bot 成員的訊息刪除
- 顯示刪除前的訊息內容
- 自動標記為已刪除

### 數據存儲
- 所有記錄保存在 `data/message_log.json` 中
- 頻道設置保存在 `data/log_channels.json` 中
- 支援多伺服器獨立配置

## Embed 資訊

每個 embed 包含以下資訊：
- **用戶ID**: 編輯/刪除訊息的用戶 ID
- **原始頻道ID**: 訊息所在的頻道 ID  
- **伺服器名稱**: 伺服器名稱和 ID
- **訊息ID**: 訊息的唯一 ID
- **時間**: 事件發生時間 (UTC+8 時區，格式: 月/日 時:分)

## 指令

### `/編刪紀錄設定 <channel>`
- **權限**: 需要管理員權限
- **功能**: 設置接收日誌的頻道
- **用法**: `/編刪紀錄設定 #日誌頻道`

## JSON 記錄格式

```json
{
  "guild_message_id": {
    "message_id": 123456789,
    "guild_id": 987654321,
    "channel_id": 555555555,
    "author_id": 111111111,
    "original_content": "原始訊息內容",
    "edit_history": ["第一次編輯", "第二次編輯"],
    "deleted": false,
    "created_at": "2026-02-12T10:30:00+08:00",
    "last_edited_at": "2026-02-12T10:35:00+08:00",
    "deleted_at": null
  }
}
```

## 注意事項

1. **Intents 要求**: 需要啟用 `guild_messages` intent
2. **權限要求**: Bot 需要在日誌頻道有發送訊息權限
3. **存儲空間**: 長時間運行會產生大量 JSON 數據
4. **隱私注意**: 請確保符合 Discord 的服務條款和用戶隱私

## 故障排除

### 常見問題

1. **指令無法使用**
   - 檢查是否有管理員權限
   - 確認 Bot 有發送訊息權限

2. **沒有收到日誌**
   - 確認已設置日誌頻道
   - 檢查 Bot 的 intents 是否正確設置
   - 確認不是 bot 訊息被忽略

3. **JSON 文件錯誤**
   - 檢查 `data/` 文件夾權限
   - 確認磁碟空間充足

## 更新日誌

- **v1.0**: 初始版本，基本編輯/刪除監聽功能
